<section class="stats-grid" *ngIf="stats">
    <div class="glass-card glass-card-3d stat-card" #tiltCard>
        <div class="stat-card-inner">
            <div class="stat-info">
                <h3>Total Banners</h3>
                <div class="stat-value" #counter>{{ stats.totalBanner }}</div>
            </div>
            <div class="stat-icon cyan">
                <svg viewBox="0 0 24 24" fill="none" stroke="var(--emerald-light)" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
                    <circle cx="8.5" cy="8.5" r="1.5" />
                    <polyline points="21 15 16 10 5 21" />
                </svg>
            </div>
        </div>
    </div>

    <div class="glass-card glass-card-3d stat-card" #tiltCard>
        <div class="stat-card-inner">
            <div class="stat-info">
                <h3>Total Services</h3>
                <div class="stat-value" #counter>{{ stats.totalService }}</div>
            </div>
            <div class="stat-icon cyan">
                <svg viewBox="0 0 24 24" fill="none" stroke="var(--emerald-light)" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <rect x="2" y="7" width="20" height="14" rx="2" ry="2" />
                    <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16" />
                </svg>
            </div>
        </div>
    </div>

    <div class="glass-card glass-card-3d stat-card" #tiltCard>
        <div class="stat-card-inner">
            <div class="stat-info">
                <h3>Total Courses</h3>
                <div class="stat-value" #counter>{{ stats.totalCourse }}</div>
            </div>
            <div class="stat-icon purple">
                <svg viewBox="0 0 24 24" fill="none" stroke="var(--coral)" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" />
                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z" />
                </svg>
            </div>
        </div>
    </div>

    <div class="glass-card glass-card-3d stat-card" #tiltCard>
        <div class="stat-card-inner">
            <div class="stat-info">
                <h3>Total Team Members</h3>
                <div class="stat-value" #counter>{{ stats.totalTeamMember }}</div>
            </div>
            <div class="stat-icon success">
                <svg viewBox="0 0 24 24" fill="none" stroke="var(--success)" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M17 21v-2a4 4 0 0 0-3-3.87" />
                    <path d="M9 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                    <circle cx="9" cy="7" r="4" />
                </svg>
            </div>
        </div>
    </div>

    <div class="glass-card glass-card-3d stat-card" #tiltCard>
        <div class="stat-card-inner">
            <div class="stat-info">
                <h3>Total Events</h3>
                <div class="stat-value" #counter>{{ stats.totalEvent }}</div>
            </div>
            <div class="stat-icon success">
                <svg viewBox="0 0 24 24" fill="none" stroke="var(--success)" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                    <line x1="16" y1="2" x2="16" y2="6" />
                    <line x1="8" y1="2" x2="8" y2="6" />
                    <line x1="3" y1="10" x2="21" y2="10" />
                </svg>
            </div>
        </div>
    </div>

    <div class="glass-card glass-card-3d stat-card" #tiltCard>
        <div class="stat-card-inner">
            <div class="stat-info">
                <h3>Total Users</h3>
                <div class="stat-value" #counter>{{ stats.totalUser }}</div>
            </div>
            <div class="stat-icon magenta">
                <svg viewBox="0 0 24 24" fill="none" stroke="var(--gold)" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
                    <circle cx="9" cy="7" r="4" />
                    <path d="M22 21v-2a4 4 0 0 0-3-3.87" />
                    <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                </svg>
            </div>
        </div>
    </div>
</section>

<!-- Content Grid -->
<section class="content-grid">
    <!-- Chart Card -->
    <div class="glass-card table-card">
        <div class="card-header">
            <div>
                <h2 class="card-title">Dashboard Statistics</h2>
                <p class="card-subtitle">Overview of platform growth</p>
            </div>
        </div>
        <div class="chart-wrapper">
            <div class="chart-container" *ngIf="stats">
                <div class="chart-y-axis">
                    <span class="y-value" *ngFor="let label of getYAxisLabels()">{{ label }}</span>
                </div>
                <div class="chart-placeholder">
                    <div class="chart-bar-group" *ngFor="let item of chartData">
                        <div class="chart-bar {{ item.class }}" [style.height]="getBarHeight(item.value)"
                            [title]="item.label + ': ' + item.value">
                        </div>
                        <span class="chart-label">{{ item.label }}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Data Table -->
    <div class="glass-card table-card">
        <div class="card-header">
            <div>
                <h2 class="card-title">Users</h2>
                <p class="card-subtitle">Latest registered users</p>
            </div>
            <div class="card-actions">
                <button class="card-btn" (click)="exportExcel()">Export</button>
            </div>
        </div>
    
        <div class="table-wrapper">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>User</th>
                        <th>Email</th>
                        <th>User ID</th>
                    </tr>
                </thead>
    
                <tbody>
                    <tr *ngFor="let user of users">
                        <td>
                            <div class="table-user">
                                <div class="table-avatar"
                                    style="background: linear-gradient(135deg, var(--emerald-light), var(--emerald));">
                                    {{ user.fullName.charAt(0) | uppercase }}
                                </div>
    
                                <div class="table-user-info">
                                    <span class="table-user-name">
                                        {{ user.fullName }}
                                    </span>
                                    <span class="table-user-email">
                                        {{ user.email }}
                                    </span>
                                </div>
                            </div>
                        </td>
    
                        <td>{{ user.email }}</td>
                        <td>#{{ user.id }}</td>
                    </tr>
    
                    <tr *ngIf="users.length === 0">
                        <td colspan="3" class="text-center">
                            No users found
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</section>